---
title: CleanCode) 경계(interface)
author: cotchan 
date: 2020-12-22 09:17:21 +0800
categories: [CleanCode] 
tags: [cleancode]
---

CleanCode 책을 바탕으로 정리한 내용입니다.            
개인 공부 목적으로 작성한 글이며 지속적으로 업데이트할 예정입니다.        

---
 
+ 시스템에 들어가는 모든 소프트웨어를 직접 개발하는 경우는 드뭅니다. 때로는 패키지를 사고, 때로는 오픈 소스를 이용합니다. 때로는 사내 다른 팀이 제공하는 컴포넌트를 이용합니다. 어떤 식으로든 이 외부 코드를 우리 코드에 깔끔하게 통합해야만 합니다.  
+ **여기서는 `소프트웨어 경계`를 깔끔하게 처리하는 기법과 기교를 살펴보겠습니다.** 

---

## 1. 외부 코드 사용하기

+ 인터페이스 제공자와 인터페이스 사용자 사이에는 특유의 긴장감이 존재합니다. 패키지 제공자나 프레임워크 제공자는 적용성을 최대한 넓히려 애씁니다. 더 많은 환경에서 돌아가야 더 많은 고객이 구입하기 때문입니다. 반면, 사용자는 자신의 요구에 집중하는 인터페이스를 원합니다. 이런 긴장으로 인해 시스템 경계에서 문제가 생길 소지가 많습니다. 
+ 한 예시로 `java.util.Map`이 있습니다. Map은 굉장히 다양한 인터페이스로 수많은 기능을 제공합니다. Map이 제공하는 기능성과 유연성은 확실히 유용하지만 그만큼 위험도 큽니다.

---

## 1-1. Good Case

```java
//good case
public class Sensors {
    private Map sensors = new HashMap();

    public Sensor getById(String id) {
        return (Sensor) sensors.get(id);
    }
    //...
}
```

+ `경계 인터페이스인 Map을 Sensors 안으로 숨깁니다.` 따라서 Map 인터페이스가 변하더라도 나머지 프로그램에는 영향을 미치지 않는다. 제네릭을 사용하든 안하든 더 이상 문제가 되지 않습니다. `Sensors 클래스 안에서 객체 유형을 관리하고 변환하기 때문입니다.` 
+ 또한 Sensors 클래스는 프로그램에 필요한 인터페이스만 제공합니다. 그래서 코드는 이해하기는 쉽지만 오용하기 어렵습니다. Sensors 클래스는 (나머지 프로그램이) 설계 규칙과 비즈니스 규칙을 따르도록 강제할 수 있습니다.
+ **Map 클래스를 사용할 때마다 위와 같이 캡슐화를 하라는 소리가 아닙니다.** **Map을 (혹은 유사한 경계 인터페이스를) 여기저기 넘기지 말라는 뜻입니다.**
    + Map과 같은 경계 인터페이스를 이용할 때는 이를 이용하는 클래스나 클래스 계열 밖으로 노출되지 않도록 주의합니다.
    + Map 인스턴스를 공개 API의 인수로 넘기거나 반환값으로 사용하지 않도록 합니다.

---

## 1-2. Bad Case

+ Bad Case.1

```java
//1.
//Sensor라는 객체를 담는 Map을 만들려면 다음과 같이 Map을 생성합니다.
Map sensors = new HashMap();

//Sensor 객체가 필요한 코드는 다음과 같이 Sensor객체를 가져옵니다. 
Sensor s = (Sensor)sensors.get(sensorId);
```

+ 위 코드는 Map이 반환하는 Object를 올바른 유형으로 변환할 `책임은` `Map을 사용하는 클라이언트에 있습니다.`

---

+ Bad Case.2

```java
//2.
Map<String, Sensor> sensors = new HashMap<Sensor>();
...
Sensor s = sensors.get(sensorId);
```

+ 위와 같이 제네릭을 사용하면 코드 가독성이 조금 더 나아집니다.
+ 그렇지만 Map<String, Sensor>가 '사용자에게 필요하지 않은 기능까지 제공한다'는 문제를 해결하지 못합니다.
+ 프로그램에서 Map<String, Sensor> 인스턴스를 여기저기로 넘긴다면 `Map 인터페이스가 변할 경우, 수정할 코드가 상당히 많아집니다.`


---

## 2. 경계 살피고 익히기


---

+ 출처	
	+ 로버트 C. 마틴, 『Clean Code』, 인사이트(2013), p68-p94

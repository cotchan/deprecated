---
title: JPA) 플러시(Flush)
author: cotchan 
date: 2021-01-19 04:25:21 +0800 
categories: [JPA, JPA_Basic]
tags: [jpa] 
---

+ **이 포스팅은 개인 공부 목적으로 작성한 포스팅입니다**

---


## 1. 플러시란

+ **영속성 컨텍스트의 변경내용을 데이터베이스에 반영하는 것입니다.**

+ **트랜 잭션을 커밋할 때 플러시가 발생합니다.**

---


## 2. 플러시가 발생하면? 

1. 변경 감지가 일어납니다.
2. 수정된 엔티티가 쓰기 지연 SQL 저장소에 등록됩니다.
3. 쓰기 지연 SQL 저장소의 쿼리를 데이터베이스에 전송합니다.
  + `등록`, `수정`, `삭제` 쿼리에 대해

---

## 3. 영속성 컨텍스트를 플러시하는 방법

1. `em.flush()` - 직접 호출합니다.
2. `트랜잭션을 커밋`하면 자동으로 Flush가 호출됩니다.
3. `JPQL 쿼리 호출` - Flush가 자동으로 호출됩니다. 

 
---

## 4. 플러시 모드 옵션

+ em.setFlushMode(FlushModeType.COMMIT)

+ `FlushModeType.AUTO`
  + 커밋이나 쿼리를 싱핼할 때 플러시(기본값)

+ `FlushModelType.COMMIT`
  + 커밋할 때만 플러시

---

## 5. 플러시 기타 주요 사항

+ **영속성 컨텍스트를 비우지 않습니다.**
  + 플러시를 해도 영속성 컨텍스트의 1차 캐시는 유지됩니다.

+ 영속성 컨텍스트의 변경 내용을 데이터베이스에 동기화합니다.
  + 오직 영속성 컨텍스트에 있는, 쓰기 지연 SQL 저장소에 있는 , 그리고 변경 감지가 일어난 것들이 DB에 반영이 되는 과정입니다.

+ **트랜잭션이라는 작업 단위가 중요합니다. 트랜잭션 커밋 직전에만 동기화하면 됩니다.**



---

+ 출처
    + [자바 ORM 표준 JPA 프로그래밍 - 기본편](https://www.inflearn.com/course/ORM-JPA-Basic)
